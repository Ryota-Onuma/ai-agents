# Backend Testing

バックエンドに特化したテスト戦略と実装パターン。

## テスト種別

### Unit Testing
- 関数/メソッド単体テスト
- ビジネスロジック検証
- データ変換処理テスト
- バリデーション処理テスト

### Integration Testing
- データベース連携テスト
- 外部 API 連携テスト
- ファイルシステム操作テスト
- メッセージキュー連携テスト

### API Testing
- エンドポイント動作テスト（正常系/異常系）
- リクエスト/レスポンス検証
- 認証/認可テスト
- レート制限テスト

### System Testing
- 実データベース・外部サービス連携の動作確認
- 重要フローの全体動作の検証は統合/API テストで代替
- パフォーマンス/セキュリティは専用セクションで実施

## テストツールと設定

### 推奨ツールスタック
- **Jest/Vitest**: テストランナーとアサーション
- **Supertest**: HTTP API テスト
- **Testcontainers**: データベーステスト環境
- **Postman/Newman**: API テスト自動化
- **Artillery/k6**: 負荷テスト

### カバレッジ基準
- Lines: >= 85%
- Branches: >= 80%
- Functions: >= 85%
- Statements: >= 85%

## テストパターン

### データベーステスト
- トランザクション処理の検証
- データ整合性テスト
- マイグレーション動作テスト
- パフォーマンス最適化検証

### API テスト
- OpenAPI/Swagger 仕様との整合性確認
- 入力値バリデーションテスト
- エラーレスポンス形式の統一性確認
- CORS 設定テスト

### セキュリティテスト
- 認証トークンの有効性検証
- 権限ベースアクセス制御テスト
- SQL インジェクション対策テスト
- XSS/CSRF 対策確認

## パフォーマンステスト

### 応答時間目標
- API レスポンス < 200ms（平均）
- データベースクエリ < 100ms（平均）
- ファイル操作 < 500ms（平均）

### 負荷テスト指標
- 同時接続数の限界値測定
- メモリリーク検出
- CPU 使用率監視
- データベース接続プール最適化
